<script>
    // Локализация
    const translations = {
        ru: {
            // Навигация
            "nav.home": "Главная",
            "nav.categories": "Категории",
            "nav.bestsellers": "Бестселлеры",
            "nav.new": "Новинки",
            "nav.sales": "Акции",
            
            // Герой секция
            "hero.title": "Откройте мир бесконечных историй",
            "hero.subtitle": "Более 10,000 книг на любой вкус. Находите свои следующие любимые произведения!",
            "search.placeholder": "Поиск по названию, автору или жанру...",
            "search.button": "Найти",
            
            // Категории
            "categories.title": "Популярные категории",
            "categories.fantasy": "Фэнтези",
            "categories.fantasyCount": "1,245 книг",
            "categories.scifi": "Фантастика",
            "categories.scifiCount": "892 книги",
            "categories.romance": "Роман",
            "categories.romanceCount": "1,567 книг",
            "categories.detective": "Детектив",
            "categories.detectiveCount": "734 книги",
            "categories.classic": "Классика",
            "categories.classicCount": "2,134 книги",
            
            // Бестселлеры
            "bestsellers.title": "Бестселлеры",
            "bestsellers.viewAll": "Смотреть все →",
            
            // Книги
            "book.details": "Подробнее",
            "book.buy": "Купить",
            
            // Названия книг
            "books.masterMargarita": "Мастер и Маргарита",
            "books.1984": "1984",
            "books.harryPotter": "Гарри Поттер и философский камень",
            "books.crimePunishment": "Преступление и наказание",
            "books.dune": "Дюна",
            "books.threeComrades": "Три товарища",
            "books.gameThrones": "Игра престолов",
            "books.annaKarenina": "Анна Каренина",
            
            // Авторы
            "authors.bulgakov": "Михаил Булгаков",
            "authors.orwell": "Джордж Оруэлл",
            "authors.rowling": "Джоан Роулинг",
            "authors.dostoevsky": "Фёдор Достоевский",
            "authors.herbert": "Фрэнк Герберт",
            "authors.remarque": "Эрих Мария Ремарк",
            "authors.martin": "Джордж Р.Р. Мартин",
            "authors.tolstoy": "Лев Толстой",
            
            // Жанры
            "genres.classic": "Классика",
            "genres.mystery": "Мистика",
            
            // Модальное окно
            "modal.reviews": "(4.8 · 142 отзыва)",
            "modal.description": "Великий роман о добре и зле, любви и предательстве, происходящий в Москве 1930-х годов. Сатана лично посещает столицу, чтобы провести весенний бал полнолуния.",
            "modal.year": "Год:",
            "modal.pages": "Страниц:",
            "modal.genre": "Жанр:",
            "modal.addToCart": "Добавить в корзину",
            "modal.addToWishlist": "♥ В избранное",
            
            // Новинки
            "newArrivals.title": "Новые поступления",
            "newArrivals.viewAll": "Смотреть все →",
            
            // Преимущества
            "features.title": "Почему выбирают нас",
            "features.freeShipping": "Бесплатная доставка",
            "features.freeShippingDesc": "Бесплатная доставка при заказе от 2000 ₽ по всей России",
            "features.quality": "Гарантия качества",
            "features.qualityDesc": "Все книги от проверенных издательств с гарантией качества",
            "features.support": "Поддержка 24/7",
            "features.supportDesc": "Круглосуточная поддержка клиентов по всем вопросам",
            "features.returns": "Легкий возврат",
            "features.returnsDesc": "Возврат в течение 30 дней без лишних вопросов",
            
            // Футер
            "footer.description": "Ваш надежный партнер в мире литературы с 2010 года",
            "footer.categories": "Категории",
            "footer.help": "Помощь",
            "footer.shipping": "Доставка",
            "footer.payment": "Оплата",
            "footer.returns": "Возврат",
            "footer.contacts": "Контакты",
            "footer.faq": "FAQ",
            "footer.subscribe": "Подписка",
            "footer.subscribeDesc": "Получайте первыми информацию о новинках и скидках",
            "footer.emailPlaceholder": "Ваш email",
            "footer.subscribeButton": "Подписаться",
            "footer.copyright": "© 2024 BookVerse. Все права защищены."
        },
        en: {
            // Навигация
            "nav.home": "Home",
            "nav.categories": "Categories",
            "nav.bestsellers": "Bestsellers",
            "nav.new": "New Arrivals",
            "nav.sales": "Sales",
            
            // Герой секция
            "hero.title": "Discover a World of Endless Stories",
            "hero.subtitle": "Over 10,000 books for every taste. Find your next favorite reads!",
            "search.placeholder": "Search by title, author, or genre...",
            "search.button": "Search",
            
            // Категории
            "categories.title": "Popular Categories",
            "categories.fantasy": "Fantasy",
            "categories.fantasyCount": "1,245 books",
            "categories.scifi": "Science Fiction",
            "categories.scifiCount": "892 books",
            "categories.romance": "Romance",
            "categories.romanceCount": "1,567 books",
            "categories.detective": "Detective",
            "categories.detectiveCount": "734 books",
            "categories.classic": "Classics",
            "categories.classicCount": "2,134 books",
            
            // Бестселлеры
            "bestsellers.title": "Bestsellers",
            "bestsellers.viewAll": "View All →",
            
            // Книги
            "book.details": "Details",
            "book.buy": "Buy",
            
            // Названия книг
            "books.masterMargarita": "The Master and Margarita",
            "books.1984": "1984",
            "books.harryPotter": "Harry Potter and the Philosopher's Stone",
            "books.crimePunishment": "Crime and Punishment",
            "books.dune": "Dune",
            "books.threeComrades": "Three Comrades",
            "books.gameThrones": "A Game of Thrones",
            "books.annaKarenina": "Anna Karenina",
            
            // Авторы
            "authors.bulgakov": "Mikhail Bulgakov",
            "authors.orwell": "George Orwell",
            "authors.rowling": "J.K. Rowling",
            "authors.dostoevsky": "Fyodor Dostoevsky",
            "authors.herbert": "Frank Herbert",
            "authors.remarque": "Erich Maria Remarque",
            "authors.martin": "George R.R. Martin",
            "authors.tolstoy": "Leo Tolstoy",
            
            // Жанры
            "genres.classic": "Classic",
            "genres.mystery": "Mystery",
            
            // Модальное окно
            "modal.reviews": "(4.8 · 142 reviews)",
            "modal.description": "A great novel about good and evil, love and betrayal, set in 1930s Moscow. Satan himself visits the capital to host the spring full moon ball.",
            "modal.year": "Year:",
            "modal.pages": "Pages:",
            "modal.genre": "Genre:",
            "modal.addToCart": "Add to Cart",
            "modal.addToWishlist": "♥ Add to Wishlist",
            
            // Новинки
            "newArrivals.title": "New Arrivals",
            "newArrivals.viewAll": "View All →",
            
            // Преимущества
            "features.title": "Why Choose Us",
            "features.freeShipping": "Free Shipping",
            "features.freeShippingDesc": "Free shipping on orders over 2000 ₽ across Russia",
            "features.quality": "Quality Guarantee",
            "features.qualityDesc": "All books from verified publishers with quality guarantee",
            "features.support": "24/7 Support",
            "features.supportDesc": "Round-the-clock customer support for all inquiries",
            "features.returns": "Easy Returns",
            "features.returnsDesc": "30-day return policy with no questions asked",
            
            // Футер
            "footer.description": "Your reliable partner in the world of literature since 2010",
            "footer.categories": "Categories",
            "footer.help": "Help",
            "footer.shipping": "Shipping",
            "footer.payment": "Payment",
            "footer.returns": "Returns",
            "footer.contacts": "Contacts",
            "footer.faq": "FAQ",
            "footer.subscribe": "Subscribe",
            "footer.subscribeDesc": "Be the first to know about new arrivals and discounts",
            "footer.emailPlaceholder": "Your email",
            "footer.subscribeButton": "Subscribe",
            "footer.copyright": "© 2024 BookVerse. All rights reserved."
        }
    };

    // Функция для переключения языка
    function switchLanguage(lang) {
        // Сохраняем выбор языка в localStorage
        localStorage.setItem('preferred-language', lang);
        
        // Обновляем текст на странице
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (translations[lang] && translations[lang][key]) {
                element.textContent = translations[lang][key];
            }
        });
        
        // Обновляем placeholder'ы
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            if (translations[lang] && translations[lang][key]) {
                element.setAttribute('placeholder', translations[lang][key]);
            }
        });
        
        // Обновляем aria-label атрибуты
        document.querySelectorAll('[data-i18n-aria-label]').forEach(element => {
            const key = element.getAttribute('data-i18n-aria-label');
            if (translations[lang] && translations[lang][key]) {
                element.setAttribute('aria-label', translations[lang][key]);
            }
        });
        
        // Обновляем alt атрибуты
        document.querySelectorAll('[data-i18n-alt]').forEach(element => {
            const key = element.getAttribute('data-i18n-alt');
            if (translations[lang] && translations[lang][key]) {
                element.setAttribute('alt', translations[lang][key]);
            }
        });
        
        // Обновляем активный язык в переключателе
        document.querySelectorAll('.lang-option').forEach(option => {
            if (option.getAttribute('data-lang') === lang) {
                option.classList.add('active');
                option.innerHTML = `<i class="fas fa-check"></i><span>${option.textContent}</span>`;
            } else {
                option.classList.remove('active');
                option.innerHTML = `<span>${option.textContent}</span>`;
            }
        });
        
        // Обновляем текст текущего языка
        const currentLangText = lang === 'ru' ? 'Русский' : 'English';
        document.getElementById('current-lang').textContent = currentLangText;
        
        // Обновляем атрибут lang у html элемента
        document.documentElement.lang = lang;
        
        // Обновляем текст в модальном окне (если оно открыто)
        updateModalLanguage(lang);
    }

    // Функция для обновления текста в модальном окне
    function updateModalLanguage(lang) {
        const modal = document.getElementById('bookModal');
        if (modal.style.display === 'block') {
            // Здесь можно обновить текст в модальном окне, если нужно
        }
    }

    // Функция для открытия модального окна
    function openBookModal() {
        const modal = document.getElementById('bookModal');
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
    }

    // Функция для закрытия модального окна
    function closeBookModal() {
        const modal = document.getElementById('bookModal');
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Загружаем сохраненный язык или используем русский по умолчанию
        const savedLang = localStorage.getItem('preferred-language') || 'ru';
        switchLanguage(savedLang);
        
        // Обработчики для переключателя языка
        const langButton = document.querySelector('.btn-lang');
        const langOptions = document.querySelector('.lang-options');
        
        if (langButton) {
            langButton.addEventListener('click', function(e) {
                e.stopPropagation();
                langOptions.classList.toggle('show');
            });
        }
        
        document.querySelectorAll('.lang-option').forEach(option => {
            option.addEventListener('click', function() {
                const lang = this.getAttribute('data-lang');
                switchLanguage(lang);
                langOptions.classList.remove('show');
            });
        });
        
        // Закрытие выпадающего списка при клике вне его
        document.addEventListener('click', function() {
            if (langOptions) {
                langOptions.classList.remove('show');
            }
        });
        
        // Находим кнопку "Подробнее" у первой книги
        const detailsBtn = document.querySelector('.book-card:first-child .btn-details');
        
        if (detailsBtn) {
            detailsBtn.addEventListener('click', function(e) {
                e.preventDefault();
                openBookModal();
            });
        }
        
        // Закрытие модалки по крестику
        const closeBtn = document.querySelector('.close');
        if (closeBtn) {
            closeBtn.addEventListener('click', closeBookModal);
        }
        
        // Закрытие модалки по клику вне зоны
        const modal = document.getElementById('bookModal');
        if (modal) {
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closeBookModal();
                }
            });
        }
        
        // Закрытие по Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeBookModal();
            }
        });
        
        // Обработчики для кнопок внутри модалки
        const modalBuyBtn = document.querySelector('.modal-actions .btn-buy');
        const wishlistBtn = document.querySelector('.modal-actions .btn-wishlist');
        
        if (modalBuyBtn) {
            modalBuyBtn.addEventListener('click', function() {
                const lang = localStorage.getItem('preferred-language') || 'ru';
                const message = lang === 'ru' ? 
                    '«Мастер и Маргарита» добавлен в корзину!' : 
                    '«The Master and Margarita» added to cart!';
                alert(message);
                closeBookModal();
            });
        }
        
        if (wishlistBtn) {
            wishlistBtn.addEventListener('click', function() {
                this.classList.toggle('active');
                const lang = localStorage.getItem('preferred-language') || 'ru';
                
                if (this.classList.contains('active')) {
                    this.innerHTML = lang === 'ru' ? '♥ В избранном' : '♥ In Wishlist';
                    this.style.background = '#4f46e5';
                    this.style.color = 'white';
                } else {
                    this.innerHTML = lang === 'ru' ? '♥ В избранное' : '♥ Add to Wishlist';
                    this.style.background = '#e5e7eb';
                    this.style.color = '#1f2937';
                }
            });
        }
        
        // Добавление товаров в корзину
        const buyButtons = document.querySelectorAll('.btn-buy');
        const cartCount = document.querySelector('.cart-count');
        let count = 0;

        buyButtons.forEach(button => {
            button.addEventListener('click', function() {
                count++;
                if (cartCount) {
                    cartCount.textContent = count;
                }
                const lang = localStorage.getItem('preferred-language') || 'ru';
                const message = lang === 'ru' ? 'Товар добавлен в корзину!' : 'Item added to cart!';
                // alert(message);
            });
        });

        // Поиск
        const searchButton = document.querySelector('.search-bar button');
        if (searchButton) {
            searchButton.addEventListener('click', function() {
                const searchInput = document.querySelector('.search-bar input');
                const lang = localStorage.getItem('preferred-language') || 'ru';
                const message = lang === 'ru' ? 'Поиск: ' : 'Search: ';
                alert(message + searchInput.value);
            });
        }
    });
</script>
